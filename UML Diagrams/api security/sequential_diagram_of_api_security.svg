<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="649px" preserveAspectRatio="none" style="width:1107px;height:649px;background:#FFFFFF;" version="1.1" viewBox="0 0 1107 649" width="1107px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="398.3359" style="stroke:#000000;stroke-width:1.5;" width="1090.4531" x="10" y="198.9609"/><rect fill="none" height="265" style="stroke:#000000;stroke-width:1.5;" width="1070.4531" x="20" y="325.2969"/><g><title>Client .Browser.App.</title><rect fill="#000000" fill-opacity="0.00000" height="578" width="8" x="105.5054" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="109" x2="109" y1="36.2969" y2="614.2969"/></g><g><title>API Endpoint .Server.</title><rect fill="#000000" fill-opacity="0.00000" height="578" width="8" x="478.6455" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="482.5493" x2="482.5493" y1="36.2969" y2="614.2969"/></g><g><title>Security Middleware</title><rect fill="#000000" fill-opacity="0.00000" height="578" width="8" x="649.0337" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="652.7417" x2="652.7417" y1="36.2969" y2="614.2969"/></g><g><title>Business Logic.Application</title><rect fill="#000000" fill-opacity="0.00000" height="578" width="8" x="837.3081" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="840.3257" x2="840.3257" y1="36.2969" y2="614.2969"/></g><g><title>Database</title><rect fill="#000000" fill-opacity="0.00000" height="578" width="8" x="1036.0527" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1039.6523" x2="1039.6523" y1="36.2969" y2="614.2969"/></g><g class="participant participant-head" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="159.0107" x="30" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145.0107" x="37" y="24.9951">Client (Browser/App)</text></g><g class="participant participant-tail" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="159.0107" x="30" y="613.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145.0107" x="37" y="633.292">Client (Browser/App)</text></g><g class="participant participant-head" data-participant="API"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164.1924" x="400.5493" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.1924" x="407.5493" y="24.9951">API Endpoint (Server)</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164.1924" x="400.5493" y="613.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.1924" x="407.5493" y="633.292">API Endpoint (Server)</text></g><g class="participant participant-head" data-participant="Security"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156.584" x="574.7417" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.584" x="581.7417" y="24.9951">Security Middleware</text></g><g class="participant participant-tail" data-participant="Security"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156.584" x="574.7417" y="613.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.584" x="581.7417" y="633.292">Security Middleware</text></g><g class="participant participant-head" data-participant="Business"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="199.9648" x="741.3257" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185.9648" x="748.3257" y="24.9951">Business Logic/Application</text></g><g class="participant participant-tail" data-participant="Business"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="199.9648" x="741.3257" y="613.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185.9648" x="748.3257" y="633.292">Business Logic/Application</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.8008" x="999.6523" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="1006.6523" y="24.9951">Database</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.8008" x="999.6523" y="613.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="1006.6523" y="633.292">Database</text></g><g class="message" data-participant-1="Client" data-participant-2="API"><polygon fill="#181818" points="470.6455,63.4297,480.6455,67.4297,470.6455,71.4297,474.6455,67.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="109.5054" x2="476.6455" y1="67.4297" y2="67.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="349.1401" x="116.5054" y="62.3638">HTTP Request (headers: JWT, CSRF; body: input data)</text></g><g class="message" data-participant-1="API" data-participant-2="Security"><polygon fill="#181818" points="641.0337,92.5625,651.0337,96.5625,641.0337,100.5625,645.0337,96.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="482.6455" x2="647.0337" y1="96.5625" y2="96.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5664" x="489.6455" y="91.4966">Sanitize Input Data</text></g><g class="message" data-participant-1="Security" data-participant-2="API"><polygon fill="#181818" points="493.6455,121.6953,483.6455,125.6953,493.6455,129.6953,489.6455,125.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="487.6455" x2="652.0337" y1="125.6953" y2="125.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.0244" x="499.6455" y="120.6294">Sanitized Data</text></g><g class="message" data-participant-1="API" data-participant-2="Security"><polygon fill="#181818" points="641.0337,150.8281,651.0337,154.8281,641.0337,158.8281,645.0337,154.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="482.6455" x2="647.0337" y1="154.8281" y2="154.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.9502" x="489.6455" y="149.7622">Validate JWT Token</text></g><g class="message" data-participant-1="Security" data-participant-2="API"><polygon fill="#181818" points="493.6455,179.9609,483.6455,183.9609,493.6455,187.9609,489.6455,183.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="487.6455" x2="652.0337" y1="183.9609" y2="183.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.6846" x="499.6455" y="178.895">JWT Valid/Invalid</text></g><path d="M10,198.9609 L74.4429,198.9609 L74.4429,206.0938 L64.4429,216.0938 L10,216.0938 L10,198.9609" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="398.3359" style="stroke:#000000;stroke-width:1.5;" width="1090.4531" x="10" y="198.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="212.0278">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79.5459" x="89.4429" y="211.1714">[JWT Invalid]</text><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="120.5054,233.2266,110.5054,237.2266,120.5054,241.2266,116.5054,237.2266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="114.5054" x2="481.6455" y1="237.2266" y2="237.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.4712" x="126.5054" y="232.1606">401 Unauthorized (JWT Invalid)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="1100.4531" y1="246.2266" y2="246.2266"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="68.9648" x="15" y="256.437">[JWT Valid]</text><g class="message" data-participant-1="API" data-participant-2="Security"><polygon fill="#181818" points="641.0337,277.1641,651.0337,281.1641,641.0337,285.1641,645.0337,281.1641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="482.6455" x2="647.0337" y1="281.1641" y2="281.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.7544" x="489.6455" y="276.0981">Check CSRF Token</text></g><g class="message" data-participant-1="Security" data-participant-2="API"><polygon fill="#181818" points="493.6455,306.2969,483.6455,310.2969,493.6455,314.2969,489.6455,310.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="487.6455" x2="652.0337" y1="310.2969" y2="310.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.895" x="499.6455" y="305.231">CSRF Valid/Invalid</text></g><path d="M20,325.2969 L84.4429,325.2969 L84.4429,332.4297 L74.4429,342.4297 L20,342.4297 L20,325.2969" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="265" style="stroke:#000000;stroke-width:1.5;" width="1070.4531" x="20" y="325.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="35" y="338.3638">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87.7959" x="99.4429" y="337.5073">[CSRF Invalid]</text><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="120.5054,359.5625,110.5054,363.5625,120.5054,367.5625,116.5054,363.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="114.5054" x2="481.6455" y1="363.5625" y2="363.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.7822" x="126.5054" y="358.4966">403 Forbidden (CSRF Invalid)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="20" x2="1090.4531" y1="372.5625" y2="372.5625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="77.2148" x="25" y="382.7729">[CSRF Valid]</text><g class="message" data-participant-1="API" data-participant-2="Security"><polygon fill="#181818" points="641.0337,403.5,651.0337,407.5,641.0337,411.5,645.0337,407.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="482.6455" x2="647.0337" y1="407.5" y2="407.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.6587" x="489.6455" y="402.4341">Apply XSS Protection</text></g><g class="message" data-participant-1="Security" data-participant-2="API"><polygon fill="#181818" points="493.6455,432.6328,483.6455,436.6328,493.6455,440.6328,489.6455,436.6328" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="487.6455" x2="652.0337" y1="436.6328" y2="436.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.0659" x="499.6455" y="431.5669">XSS-Safe Data</text></g><g class="message" data-participant-1="API" data-participant-2="Business"><polygon fill="#181818" points="829.3081,461.7656,839.3081,465.7656,829.3081,469.7656,833.3081,465.7656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="482.6455" x2="835.3081" y1="465.7656" y2="465.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318.3413" x="489.6455" y="460.6997">Process Request (using sanitized, XSS-safe data)</text></g><g class="message" data-participant-1="Business" data-participant-2="DB"><polygon fill="#181818" points="1028.0527,490.8984,1038.0527,494.8984,1028.0527,498.8984,1032.0527,494.8984" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="841.3081" x2="1034.0527" y1="494.8984" y2="494.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.7446" x="848.3081" y="489.8325">Database Query/Operation</text></g><g class="message" data-participant-1="DB" data-participant-2="Business"><polygon fill="#181818" points="852.3081,520.0313,842.3081,524.0313,852.3081,528.0313,848.3081,524.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="846.3081" x2="1039.0527" y1="524.0313" y2="524.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.1719" x="858.3081" y="518.9653">Data/Result</text></g><g class="message" data-participant-1="Business" data-participant-2="API"><polygon fill="#181818" points="493.6455,549.1641,483.6455,553.1641,493.6455,557.1641,489.6455,553.1641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="487.6455" x2="840.3081" y1="553.1641" y2="553.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.8906" x="499.6455" y="548.0981">API Response Data</text></g><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="120.5054,578.2969,110.5054,582.2969,120.5054,586.2969,116.5054,582.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="114.5054" x2="481.6455" y1="582.2969" y2="582.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.8867" x="126.5054" y="577.231">HTTP Response (sanitized, safe output)</text></g><!--SRC=[RP9TJy8m58RlzojEl8A41OrUpSI43uaOZSZmuxPiHsXOsjfs4FprzfHrRC2IfTlwdFUyftiLqvPdN35XOLHmT0ipS5KzTePQxWpg_a2fxbMa6l1WDlKahOyYLv8JdwBUeZv1KynApUtUy_NBAy_p0dTCOviUbeOBDCRJzSkBNF6CR1GyOvPBqIuQ3pq-PfOjcN6AKJL1_41E4tXQB6OmnzyIZREvHfQZDWayVorwC4hdatjOodoV01Ugj90xdMv4exdwu3Y1b0bk-H_2r5FKBQhdYKEhGEK7u5pcanNSTK3g3WkvGN51XVOys9-ABQrHn0hhFuSFu2ulxceEuoPmTtq37uALTYsrzz1fL7GZB0mUfOyAJNkZDMORVoYLEQBE3NhWn26HvDBlDMrUjdeB4wcNBWSeeDEiwVeYR_ROfYtKT4onsCDtci9CIuiPvQEcpvqxC4xP3rR_vqGsH2uXiOooLyU6TbPWml_jUIL3IeV01AKwjKvkF4mWn1BUIzJx_fj2pLeUNNpZLckgwC_Hb8Mze1e68SSEKbAOYyCq3hlAVyLs6ZDu_xAqBj7LiOiySlS_]--></g></svg>