<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="815px" preserveAspectRatio="none" style="width:1488px;height:815px;background:#FFFFFF;" version="1.1" viewBox="0 0 1488 815" width="1488px" zoomAndPan="magnify"><title>Full Login Functionality via CAS, JWT, DB, and Roles</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="410.6553" x="539.7869" y="27.9951">Full Login Functionality via CAS, JWT, DB, and Roles</text><rect fill="none" height="423.6641" style="stroke:#000000;stroke-width:1.5;" width="1471.229" x="10" y="294.2578"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="616.3281" width="8" x="34.9551" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="38" x2="38" y1="118.5938" y2="734.9219"/></g><g><title>Web Browser</title><rect fill="#000000" fill-opacity="0.00000" height="616.3281" width="8" x="228.5073" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="232.0913" x2="232.0913" y1="118.5938" y2="734.9219"/></g><g><title>Frontend App</title><rect fill="#000000" fill-opacity="0.00000" height="616.3281" width="8" x="505.125" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="508.6699" x2="508.6699" y1="118.5938" y2="734.9219"/></g><g><title>CAS Server</title><rect fill="#000000" fill-opacity="0.00000" height="616.3281" width="8" x="727.4829" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="731.1831" x2="731.1831" y1="118.5938" y2="734.9219"/></g><g><title>Backend Auth API</title><rect fill="#000000" fill-opacity="0.00000" height="616.3281" width="8" x="1018.5098" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1022.3984" x2="1022.3984" y1="118.5938" y2="734.9219"/></g><g><title>Database</title><rect fill="#000000" fill-opacity="0.00000" height="616.3281" width="8" x="1426.8286" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1430.4282" x2="1430.4282" y1="118.5938" y2="734.9219"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="20" y="115.292">User</text><ellipse cx="38.9551" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.9551,58.7969 L38.9551,85.7969 M25.9551,66.7969 L51.9551,66.7969 M38.9551,85.7969 L25.9551,100.7969 M38.9551,85.7969 L51.9551,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="20" y="746.917">User</text><ellipse cx="38.9551" cy="758.7188" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.9551,766.7188 L38.9551,793.7188 M25.9551,774.7188 L51.9551,774.7188 M38.9551,793.7188 L25.9551,808.7188 M38.9551,793.7188 L51.9551,808.7188" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Browser"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.832" x="179.0913" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="186.0913" y="107.292">Web Browser</text></g><g class="participant participant-tail" data-participant="Browser"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.832" x="179.0913" y="733.9219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="186.0913" y="753.917">Web Browser</text></g><g class="participant participant-head" data-participant="Frontend"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.9102" x="454.6699" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.9102" x="461.6699" y="107.292">Frontend App</text></g><g class="participant participant-tail" data-participant="Frontend"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.9102" x="454.6699" y="733.9219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.9102" x="461.6699" y="753.917">Frontend App</text></g><g class="participant participant-head" data-participant="CAS"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.5996" x="685.1831" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.5996" x="692.1831" y="107.292">CAS Server</text></g><g class="participant participant-tail" data-participant="CAS"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.5996" x="685.1831" y="733.9219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.5996" x="692.1831" y="753.917">CAS Server</text></g><g class="participant participant-head" data-participant="API"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.2227" x="953.3984" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.2227" x="960.3984" y="107.292">Backend Auth API</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.2227" x="953.3984" y="733.9219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.2227" x="960.3984" y="753.917">Backend Auth API</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.8008" x="1390.4282" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="1397.4282" y="107.292">Database</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.8008" x="1390.4282" y="733.9219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="1397.4282" y="753.917">Database</text></g><g class="message" data-participant-1="User" data-participant-2="Browser"><polygon fill="#181818" points="220.5073,145.7266,230.5073,149.7266,220.5073,153.7266,224.5073,149.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="38.9551" x2="226.5073" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.1123" x="45.9551" y="144.6606">Navigate to Login Page</text></g><g class="message" data-participant-1="Browser" data-participant-2="Frontend"><polygon fill="#181818" points="497.125,174.8594,507.125,178.8594,497.125,182.8594,501.125,178.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="232.5073" x2="503.125" y1="178.8594" y2="178.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.2383" x="239.5073" y="173.7935">Display login form/page</text></g><g class="message" data-participant-1="Frontend" data-participant-2="CAS"><polygon fill="#181818" points="719.4829,203.9922,729.4829,207.9922,719.4829,211.9922,723.4829,207.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="509.125" x2="725.4829" y1="207.9922" y2="207.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4512" x="516.125" y="202.9263">Redirect to CAS Login</text></g><g class="message" data-participant-1="User" data-participant-2="CAS"><polygon fill="#181818" points="719.4829,233.125,729.4829,237.125,719.4829,241.125,723.4829,237.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="38.9551" x2="725.4829" y1="237.125" y2="237.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0649" x="45.9551" y="232.0591">Enter credentials</text></g><g class="message" data-participant-1="CAS" data-participant-2="CAS"><line style="stroke:#181818;stroke-width:1;" x1="731.4829" x2="773.4829" y1="266.2578" y2="266.2578"/><line style="stroke:#181818;stroke-width:1;" x1="773.4829" x2="773.4829" y1="266.2578" y2="279.2578"/><line style="stroke:#181818;stroke-width:1;" x1="732.4829" x2="773.4829" y1="279.2578" y2="279.2578"/><polygon fill="#181818" points="742.4829,275.2578,732.4829,279.2578,742.4829,283.2578,738.4829,279.2578" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.7959" x="738.4829" y="261.1919">Authenticate credentials</text></g><path d="M10,294.2578 L74.4429,294.2578 L74.4429,301.3906 L64.4429,311.3906 L10,311.3906 L10,294.2578" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="423.6641" style="stroke:#000000;stroke-width:1.5;" width="1471.229" x="10" y="294.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="307.3247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="114.7856" x="89.4429" y="306.4683">[Credentials valid]</text><g class="message" data-participant-1="CAS" data-participant-2="Frontend"><polygon fill="#181818" points="520.125,328.5234,510.125,332.5234,520.125,336.5234,516.125,332.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="514.125" x2="730.4829" y1="332.5234" y2="332.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.3579" x="526.125" y="327.4575">Redirect with CAS ticket/token</text></g><g class="message" data-participant-1="Frontend" data-participant-2="API"><polygon fill="#181818" points="1010.5098,357.6563,1020.5098,361.6563,1010.5098,365.6563,1014.5098,361.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="509.125" x2="1016.5098" y1="361.6563" y2="361.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.603" x="516.125" y="356.5903">Send CAS ticket/token to backend</text></g><g class="message" data-participant-1="API" data-participant-2="CAS"><polygon fill="#181818" points="742.4829,386.7891,732.4829,390.7891,742.4829,394.7891,738.4829,390.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="736.4829" x2="1021.5098" y1="390.7891" y2="390.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.5596" x="748.4829" y="385.7231">Validate CAS ticket/token</text></g><g class="message" data-participant-1="CAS" data-participant-2="API"><polygon fill="#181818" points="1010.5098,415.9219,1020.5098,419.9219,1010.5098,423.9219,1014.5098,419.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="731.4829" x2="1016.5098" y1="419.9219" y2="419.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.0269" x="738.4829" y="414.856">Ticket valid, return user info (e.g., email)</text></g><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#181818" points="1418.8286,445.0547,1428.8286,449.0547,1418.8286,453.0547,1422.8286,449.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1022.5098" x2="1424.8286" y1="449.0547" y2="449.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378.0347" x="1029.5098" y="443.9888">Query or create user by CAS identifier (e.g., email, tuc_id)</text></g><g class="message" data-participant-1="DB" data-participant-2="API"><polygon fill="#181818" points="1033.5098,474.1875,1023.5098,478.1875,1033.5098,482.1875,1029.5098,478.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1027.5098" x2="1429.8286" y1="478.1875" y2="478.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384.3188" x="1039.5098" y="473.1216">Return user record (with roles: admin/user, free_food, etc.)</text></g><g class="message" data-participant-1="API" data-participant-2="API"><line style="stroke:#181818;stroke-width:1;" x1="1022.5098" x2="1064.5098" y1="507.3203" y2="507.3203"/><line style="stroke:#181818;stroke-width:1;" x1="1064.5098" x2="1064.5098" y1="507.3203" y2="520.3203"/><line style="stroke:#181818;stroke-width:1;" x1="1023.5098" x2="1064.5098" y1="520.3203" y2="520.3203"/><polygon fill="#181818" points="1033.5098,516.3203,1023.5098,520.3203,1033.5098,524.3203,1029.5098,520.3203" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.0747" x="1029.5098" y="502.2544">Generate JWT (with user_id, roles, type, etc.)</text></g><g class="message" data-participant-1="API" data-participant-2="Browser"><polygon fill="#181818" points="243.5073,545.4531,233.5073,549.4531,243.5073,553.4531,239.5073,549.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.5073" x2="1021.5098" y1="549.4531" y2="549.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="462.6426" x="249.5073" y="544.3872">Set JWT in sessionStorage/cookie; set CSRF token; return login success</text></g><g class="message" data-participant-1="Browser" data-participant-2="Frontend"><polygon fill="#181818" points="497.125,574.5859,507.125,578.5859,497.125,582.5859,501.125,578.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="232.5073" x2="503.125" y1="578.5859" y2="578.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.6177" x="239.5073" y="573.52">Store session info (JWT, user role, etc.)</text></g><g class="message" data-participant-1="Frontend" data-participant-2="User"><polygon fill="#181818" points="49.9551,603.7188,39.9551,607.7188,49.9551,611.7188,45.9551,607.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.9551" x2="508.125" y1="607.7188" y2="607.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="343.5669" x="55.9551" y="602.6528">Redirect to authorized area (User/Admin Dashboard)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="1481.229" y1="616.7188" y2="616.7188"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="126.3872" x="15" y="626.9292">[Credentials invalid]</text><g class="message" data-participant-1="CAS" data-participant-2="Frontend"><polygon fill="#181818" points="520.125,647.6563,510.125,651.6563,520.125,655.6563,516.125,651.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="514.125" x2="730.4829" y1="651.6563" y2="651.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.313" x="526.125" y="646.5903">Redirect with error</text></g><g class="message" data-participant-1="Frontend" data-participant-2="Browser"><polygon fill="#181818" points="243.5073,676.7891,233.5073,680.7891,243.5073,684.7891,239.5073,680.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.5073" x2="508.125" y1="680.7891" y2="680.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.1943" x="249.5073" y="675.7231">Show authentication failure</text></g><g class="message" data-participant-1="Browser" data-participant-2="User"><polygon fill="#181818" points="49.9551,705.9219,39.9551,709.9219,49.9551,713.9219,45.9551,709.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.9551" x2="231.5073" y1="709.9219" y2="709.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.5522" x="55.9551" y="704.856">Show login error message</text></g><!--SRC=[ZLF1Zjf03BtdAwmziL8AzwnKYMnArQggjh1qZsYOE31Yc8cS2OX-VUr90c6xX-QIPFpy_Fp63YPOX4LhBVpmE-Fuq-bWl5FMX0kSZ8Bd-Ig5xs-lAHHv2igLiFGMcoHHEdY2TOEKr8g2qQPMBi336suX9t_cm0EePlY-1ot8ku1CDg_hY1eExc5S75P8fvwAV-_ZkTA7oDA6FSnVlaKKl-zGXGfggngKM94dYKY6Jvy7OHdyL2UpKm4X-Dw65xN3f8yBT52NGM6QsgeBs8YhF1rdjO2l3J6QPMQmnD8GwY2aqaOaljQEa2-SGQ09ItJ1ADia0XoYqfESQr4s1YNA1dY-7S29RwjCW9y-_oRtgk9is249C-41monuDYxcZ9MpTHaRpZ_leTB6jdCxPZ7oglItr1UL7_97JGFtQunsYbCW32qvQCKKuoeF4vpkfYdWKHdxc8mB5Na6lrga2_XecPIBUTjBh62Y6vNXap592g7L6rC-HguYlobPZcgpGvvAc4IJICOx0rKUZPj9E8MA43ULzomPWvxUAujiNz4XYIRUb9v7KZUnIo5a8PSQX_nH-dKAL-oBPFDODTWql8GhNZ2UhPds_c3mYO_vtbVB1KHpdmRxkb5iMgqvhPFsuUWA7GxSlTzniJiFMELOtdWirb7WUA8L3wSdymTBK7mPC178R2wUyRur-wrNnAQZvRKRZwfn_psiIEJf7oatk_R-76NqEo8zLNpZBU5x2zQtXCwhI0r7Ta9Mbvd_0W00]--></g></svg>